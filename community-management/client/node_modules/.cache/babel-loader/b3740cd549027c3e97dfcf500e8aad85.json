{"ast":null,"code":"import _objectSpread from\"/Users/shihaohuang/Documents/Mercury/community-management/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/shihaohuang/Documents/Mercury/community-management/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import Paper from\"@material-ui/core/Paper\";import TextField from\"@material-ui/core/TextField\";import InputAdornment from\"@material-ui/core/InputAdornment\";import Snackbar from\"@material-ui/core/Snackbar\";import UsernameIcon from\"@material-ui/icons/Person\";import PasswordIcon from\"@material-ui/icons/VpnKey\";import ArrowForwardIcon from'@material-ui/icons/ArrowForward';import Fab from\"@material-ui/core/Fab\";import{withStyles}from\"@material-ui/core\";import{useDispatch,useSelector}from\"react-redux\";import{login}from\"../actions/auth.action\";import'./Login.scss';import{appConstants}from\"../constants/constant\";import{NavLink}from\"react-router-dom\";import{checkLogin}from\"../actions/user.action\";import AccountCircleIcon from'@material-ui/icons/AccountCircle';import{getApplication}from\"../actions/application.action\";import{getUserInfo}from\"../actions/userInfo.action\";var styles={root:{marginTop:'25px','& .MuiInput-underline:before':{borderBottomColor:'white'},'& .MuiInput-underline:after':{borderBottomColor:'white'},'& .MuiInput-underline:before:hover':{borderBottomColor:'white'},'& .MuiInput-underline:hover:not(.MuiInput-disabled):before':{borderBottomColor:'white'},'& .MuiFormLabel-root':{color:'white'}},input:{color:'white'},button:{'&.MuiButtonBase-root':{margin:'50px 0 25px'}}};var Login=function Login(props){var classes=props.classes;// React hooks  React.useState()\nvar _useState=useState({username:'',password:'',profiles:[],isactive:'No'}),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),open=_useState4[0],setOpen=_useState4[1];var dispatch=useDispatch();var loginState=useSelector(function(appState){return{auth:appState.message,user:appState.user,msg:appState.user?appConstants.LOGIN_SUCCESS_MESSAGE+user.username:appConstants.LOGIN_FAILURE_MESSAGE};});React.useEffect(function(){dispatch(checkLogin());},[loginState.auth]);var handleFormControl=function handleFormControl(event){var newUser=_objectSpread({},user);newUser[event.target.name]=event.target.value;setUser(newUser);};var handleSubmit=function handleSubmit(event){event.preventDefault();dispatch(login(user,function(){setOpen(true);setTimeout(function(){props.history.push('/user-page');},1000);},function(){return setOpen(true);}));// setTimeout(\n//     () => {\n// console.log(loginState.user);\n// if(loginState.user!==null) {\n//\n//     if (loginState.user.profiles[0].id === 2) {\n//         console.log('%%%%%%%%%2');\n//         props.history.push('/user-page');\n//     }\n//     else\n//     {\n//         console.log('%%%%%%%%%3');\n//         props.history.push('/admin-page');\n//\n//     }\n// }\n// },2000);\n};return/*#__PURE__*/React.createElement(\"div\",{className:\"daddy1\"},/*#__PURE__*/React.createElement(\"div\",{className:\"contentLogin\"},/*#__PURE__*/React.createElement(Paper,{className:\"Login\",elevation:10},/*#__PURE__*/React.createElement(\"div\",{className:\"overlay\"}),/*#__PURE__*/React.createElement(\"form\",{className:\"login-form\",onSubmit:handleSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"login-icon\"},/*#__PURE__*/React.createElement(AccountCircleIcon,null)),/*#__PURE__*/React.createElement(TextField,{name:\"username\",className:classes.root,label:\"Username\",value:user.username,onChange:handleFormControl,InputProps:{className:classes.input,startAdornment:/*#__PURE__*/React.createElement(InputAdornment,{position:\"start\"},/*#__PURE__*/React.createElement(UsernameIcon,null))}}),/*#__PURE__*/React.createElement(TextField,{name:\"password\",className:classes.root,label:\"Password\",type:\"password\",value:user.password,onChange:handleFormControl,InputProps:{className:classes.input,startAdornment:/*#__PURE__*/React.createElement(InputAdornment,{position:\"start\"},/*#__PURE__*/React.createElement(PasswordIcon,null))}}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(NavLink,{to:appConstants.registerRoute},\"Register\"),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(NavLink,{to:appConstants.login2Route},\"AdminLogin\"),/*#__PURE__*/React.createElement(Fab,{variant:\"extended\",size:\"medium\",color:\"default\",\"aria-label\":\"Login\",className:classes.button,type:\"submit\",disabled:!user.username||!user.password},\"Sign In\",/*#__PURE__*/React.createElement(ArrowForwardIcon,null))),/*#__PURE__*/React.createElement(Snackbar,{className:loginState.user?'success':'failure',open:open,onClose:function onClose(){return setOpen(false);},autoHideDuration:3000,message:/*#__PURE__*/React.createElement(\"span\",null,loginState.msg)}))));};export default withStyles(styles)(Login);","map":{"version":3,"sources":["/Users/shihaohuang/Documents/Mercury/community-management/client/src/navbar/Login.js"],"names":["React","useState","Paper","TextField","InputAdornment","Snackbar","UsernameIcon","PasswordIcon","ArrowForwardIcon","Fab","withStyles","useDispatch","useSelector","login","appConstants","NavLink","checkLogin","AccountCircleIcon","getApplication","getUserInfo","styles","root","marginTop","borderBottomColor","color","input","button","margin","Login","props","classes","username","password","profiles","isactive","user","setUser","open","setOpen","dispatch","loginState","appState","auth","message","msg","LOGIN_SUCCESS_MESSAGE","LOGIN_FAILURE_MESSAGE","useEffect","handleFormControl","event","newUser","target","name","value","handleSubmit","preventDefault","setTimeout","history","push","className","startAdornment","registerRoute","login2Route"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\nimport Paper from \"@material-ui/core/Paper\";\nimport TextField from \"@material-ui/core/TextField\";\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport UsernameIcon from \"@material-ui/icons/Person\";\nimport PasswordIcon from \"@material-ui/icons/VpnKey\"\nimport ArrowForwardIcon from '@material-ui/icons/ArrowForward';\nimport Fab from \"@material-ui/core/Fab\";\nimport {withStyles} from \"@material-ui/core\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {login} from \"../actions/auth.action\";\nimport './Login.scss';\nimport {appConstants} from \"../constants/constant\";\nimport {NavLink} from \"react-router-dom\";\nimport {checkLogin} from \"../actions/user.action\";\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle';\nimport {getApplication} from \"../actions/application.action\";\nimport {getUserInfo} from \"../actions/userInfo.action\";\n\nconst styles = {\n    root: {\n        marginTop: '25px',\n        '& .MuiInput-underline:before': {\n            borderBottomColor: 'white'\n        },\n        '& .MuiInput-underline:after': {\n            borderBottomColor: 'white'\n        },\n        '& .MuiInput-underline:before:hover': {\n            borderBottomColor: 'white'\n        },\n        '& .MuiInput-underline:hover:not(.MuiInput-disabled):before': {\n            borderBottomColor: 'white'\n        },\n        '& .MuiFormLabel-root': {\n            color: 'white'\n        }\n    },\n    input: {\n        color: 'white'\n    },\n    button: {\n        '&.MuiButtonBase-root': {\n            margin: '50px 0 25px'\n        }\n    }\n\n};\n\nconst Login = (props) => {\n    const {classes} = props;\n    // React hooks  React.useState()\n    const [user, setUser] = useState({\n        username: '',\n        password: '',\n        profiles:[],\n        isactive: 'No'\n    });\n\n    const [open, setOpen] = useState(false);\n\n    const dispatch = useDispatch();\n\n    const loginState = useSelector(appState => {\n        return {\n            auth: appState.message,\n            user: appState.user,\n            msg: appState.user ?\n                appConstants.LOGIN_SUCCESS_MESSAGE + user.username :\n                appConstants.LOGIN_FAILURE_MESSAGE\n        };\n    });\n\n\n\n    React.useEffect(()=>{\n        dispatch(checkLogin());\n    }, [loginState.auth]);\n\n\n    const handleFormControl = (event) => {\n        const newUser = {...user};\n        newUser[event.target.name] = event.target.value;\n        setUser(newUser);\n    };\n\n    const handleSubmit = (event) => {\n        event.preventDefault();\n        dispatch(login(\n            user,\n            () => {\n                setOpen(true);\n                setTimeout(\n                    () => {props.history.push('/user-page');},1000\n                );\n            },\n            () => setOpen(true)\n        ));\n\n\n\n\n\n        // setTimeout(\n        //     () => {\n                // console.log(loginState.user);\n                // if(loginState.user!==null) {\n                //\n                //     if (loginState.user.profiles[0].id === 2) {\n                //         console.log('%%%%%%%%%2');\n                //         props.history.push('/user-page');\n                //     }\n                //     else\n                //     {\n                //         console.log('%%%%%%%%%3');\n                //         props.history.push('/admin-page');\n                //\n                //     }\n                // }\n            // },2000);\n\n\n\n    };\n\n\n    return (\n        <div className=\"daddy1\">\n        <div className=\"contentLogin\">\n        <Paper className=\"Login\" elevation={10} >\n            <div className=\"overlay\" />\n            <form className=\"login-form\" onSubmit={handleSubmit}>\n                <div className=\"login-icon\">\n                    <AccountCircleIcon/>\n                </div>\n                <TextField\n                    name=\"username\"\n                    className={classes.root}\n                    label=\"Username\"\n                    value={user.username}\n                    onChange={handleFormControl}\n                    InputProps={{\n                        className: classes.input,\n                        startAdornment: (\n                            <InputAdornment position=\"start\">\n                                <UsernameIcon />\n                            </InputAdornment>\n                        ),\n                    }}\n                />\n                <TextField\n                    name=\"password\"\n                    className={classes.root}\n                    label=\"Password\"\n                    type=\"password\"\n                    value={user.password}\n                    onChange={handleFormControl}\n                    InputProps={{\n                        className: classes.input,\n                        startAdornment: (\n                            <InputAdornment position=\"start\">\n                                <PasswordIcon />\n                            </InputAdornment>\n                        )\n                    }}\n                />\n                <br/>\n                <NavLink to={appConstants.registerRoute}>\n                    Register\n                </NavLink>\n                <br/>\n                <NavLink to={appConstants.login2Route}>\n                    AdminLogin\n                </NavLink>\n                <Fab\n                    variant=\"extended\"\n                    size=\"medium\"\n                    color=\"default\"\n                    aria-label=\"Login\"\n                    className={classes.button}\n                    type=\"submit\"\n                    disabled={!user.username || !user.password}\n                >\n                    Sign In\n                    <ArrowForwardIcon />\n                </Fab>\n            </form>\n            <Snackbar\n                className={loginState.user ? 'success' : 'failure'}\n                open={open}\n                onClose={() => setOpen(false)}\n                autoHideDuration={3000}\n                message={<span>{loginState.msg}</span>}\n            />\n        </Paper>\n        </div>\n        </div>\n    );\n};\nexport default withStyles(styles)(Login);\n"]},"metadata":{},"sourceType":"module"}